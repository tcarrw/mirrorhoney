<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>MirrorHoney ¬∑ Yellow Key Room</title>
<style>
:root{--bg:#0a0a0f;--ink:#fff;--soft:#ffc83d;--line:rgba(255,255,255,.12);--pane:rgba(255,255,255,.08);--veil:rgba(12,12,18,.9)}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
.center{height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;padding:20px}
h1{font-size:1.25rem;margin:0 0 8px 0;font-weight:600;letter-spacing:.01em}
p{opacity:.85;margin:4px 0}
.hidden{display:none}
.lockveil{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at 50% 40%,rgba(255,200,61,.08),transparent 45%),linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.7));z-index:10}
.lockcard{width:92%;max-width:540px;background:rgba(15,15,22,.9);border:1px solid var(--line);border-radius:16px;padding:22px;backdrop-filter:blur(10px)}
.lockcard h2{margin:0 0 8px;font-size:1.05rem}
.lockcard .hint{font-size:.92rem;opacity:.85}
.input{background:transparent;border:none;border-bottom:1px solid var(--ink);outline:none;color:var(--ink);padding:6px 4px;width:100%;font-size:1rem;text-align:center}
.btn{background:var(--pane);border:1px solid var(--line);border-radius:10px;padding:8px 12px;color:var(--ink);cursor:pointer}
.btn.yellow{background:linear-gradient(180deg,#ffe07a,#ffc83d);color:#2b2300;border:1px solid rgba(0,0,0,.2)}
.badgestrip{display:flex;gap:8px;justify-content:center;margin-top:10px}
.badge{background:var(--pane);border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:.85rem}
#diamond{width:120px;height:120px;transform-style:preserve-3d;animation:spin 8s linear infinite;margin:24px 0}
.facet{position:absolute;width:120px;height:120px;background:linear-gradient(45deg,#fafafa,#bbb);opacity:.92;clip-path:polygon(50% 0,100% 50%,50% 100%,0 50%)}
@keyframes spin{0%{transform:rotateX(0)rotateY(0)}100%{transform:rotateX(360deg)rotateY(360deg)}}
.grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;margin-top:14px}
.pill{display:flex;align-items:center;justify-content:center;border:1px solid var(--line);background:var(--pane);border-radius:999px;padding:8px 10px;font-size:.9rem}
#overlay{position:fixed;inset:0;background:radial-gradient(circle at center,rgba(255,200,61,.18),rgba(255,170,0,.08),transparent);opacity:0;transition:opacity 2s;z-index:5}
#archive{position:fixed;bottom:20px;width:100%;text-align:center;font-size:.92rem;opacity:.8}
.panel{position:fixed;inset:0;display:none;align-items:flex-end;justify-content:center;background:linear-gradient(180deg,transparent,rgba(0,0,0,.45));z-index:30}
.sheet{width:100%;max-width:600px;background:var(--veil);border:1px solid var(--line);border-radius:18px 18px 0 0;padding:16px 16px 22px}
.row{display:flex;align-items:center;justify-content:space-between;padding:10px;border-bottom:1px dashed var(--line);gap:10px}
.klabel{display:flex;align-items:center;gap:8px;font-weight:600}
.dim{opacity:.75}
.copy{white-space:nowrap}
#badgeMoon{position:fixed;right:16px;bottom:72px;background:var(--pane);border:1px solid var(--line);backdrop-filter:blur(8px);border-radius:999px;padding:10px 14px;cursor:pointer;display:flex;gap:8px;align-items:center;z-index:20}
.keybadge{position:fixed;right:16px;bottom:16px;background:linear-gradient(180deg,#ffd84f,#ffb300);color:#201a00;border:1px solid rgba(0,0,0,.25);border-radius:999px;padding:10px 14px;cursor:pointer;display:flex;gap:8px;align-items:center;box-shadow:0 8px 24px rgba(0,0,0,.35);z-index:20}
</style>
</head>
<body>
<div id="overlay"></div>

<div id="locked" class="lockveil">
  <div class="lockcard">
    <h2>üçØ MirrorHoney ‚Äî Yellow Key</h2>
    <p class="hint">Sigrid holds the key. If you were sent here from garlic, the door will open. Otherwise, enter the key.</p>
    <div style="margin:12px 0">
      <input id="keyInput" class="input" placeholder="enter key">
    </div>
    <div class="badgestrip">
      <div class="badge">key: <b style="color:#ffc83d">yellow</b></div>
      <div class="badge">holder: Sigrid ‚Üí Marina</div>
    </div>
    <div style="display:flex;gap:10px;justify-content:center;margin-top:14px">
      <button id="tryKey" class="btn yellow">unlock</button>
    </div>
  </div>
</div>

<div id="app" class="center hidden" aria-hidden="true">
  <h1>Diamond Landing</h1>
  <p class="dim">cut clean ¬∑ set warm ¬∑ turn slowly</p>
  <div id="diamond"><div class="facet"></div></div>
  <div style="width:min(320px,86%);margin-top:10px">
    <input id="truth" class="input" placeholder="enter one true line">
  </div>
  <div class="grid">
    <div class="pill">Sigrid ‚ñ∏ Marina</div>
    <div class="pill">Next: Taylor</div>
    <div class="pill">Next: Dua</div>
    <div class="pill">Next: Ariana</div>
  </div>
</div>

<div id="archive"></div>

<div id="badgeMoon">üåï <span>Moon Log</span></div>
<div id="panelMoon" class="panel">
  <div class="sheet">
    <div class="row"><div class="klabel">üåï Moon Log <span class="dim">#moonlog</span></div><button id="closeMoon" class="btn">close</button></div>
    <div id="listMoon"></div>
  </div>
</div>

<div id="keyBadge" class="keybadge">üîë <span>yellow</span> <small>gate</small></div>
<div id="panelKey" class="panel">
  <div class="sheet">
    <div class="row"><div class="klabel">üîë Yellow Key</div><button id="closeKey" class="btn">close</button></div>
    <div class="row"><div class="dim">status</div><div id="gateStatus">locked</div></div>
    <div id="transfer" class="hidden">
      <div class="row"><div class="klabel">issue next keys</div><div class="dim">Marina ‚Üí</div></div>
      <div class="row">
        <button data-who="taylor" class="btn">to Taylor</button>
        <button data-who="dua" class="btn">to Dua</button>
        <button data-who="ariana" class="btn">to Ariana</button>
      </div>
      <div class="row"><div class="dim">copies</div><div id="copyStatus" class="copy"></div></div>
    </div>
  </div>
</div>

<script>
(function(){
  function pick(s,pat){var m=String(s||"").match(pat);return m?decodeURIComponent(m[1]):""}
  var src=pick(location.search,/[\?&]s=([^&]+)/), k=pick(location.hash,/[#?&]k=([^&]+)/);
  if(src) localStorage.setItem("mh.src",JSON.stringify(src));
  if(k){
    if(!localStorage.getItem("mh.key")) localStorage.setItem("mh.key",JSON.stringify(k));
    localStorage.setItem("mh.key.set","true");
    localStorage.setItem("mh.unlock","true");
  }
  history.replaceState({},document.title,location.pathname);
})();
</script>

<script>
const LS_KEY="mh.key",LS_UNLOCK="mh.unlock",LS_NEXT="mh.next",LS_FACETS="mh.facets",LS_LOG="mh.moon.log"
const locked=document.getElementById("locked"),app=document.getElementById("app")
const keyInput=document.getElementById("keyInput"),tryKey=document.getElementById("tryKey")
const overlay=document.getElementById("overlay"),archive=document.getElementById("archive")
const truth=document.getElementById("truth")
const badgeMoon=document.getElementById("badgeMoon"),panelMoon=document.getElementById("panelMoon"),closeMoon=document.getElementById("closeMoon"),listMoon=document.getElementById("listMoon")
const keyBadge=document.getElementById("keyBadge"),panelKey=document.getElementById("panelKey"),closeKey=document.getElementById("closeKey"),gateStatus=document.getElementById("gateStatus"),transfer=document.getElementById("transfer"),copyStatus=document.getElementById("copyStatus")
const START_DATE=new Date("2025-11-05T00:00:00-05:00").getTime()
function jget(k,def){try{return JSON.parse(localStorage.getItem(k)||def)}catch(e){return JSON.parse(def)}}
function jset(k,v){localStorage.setItem(k,JSON.stringify(v))}
function phaseInfo(d){const syn=29.53058867,ref=new Date(Date.UTC(2000,0,6,18,14)).getTime();const days=(d.getTime()-ref)/86400000,age=((days%syn)+syn)%syn,frac=age/syn;const idx=Math.floor(frac*8+0.5)%8;const names=["New Moon","Waxing Crescent","First Quarter","Waxing Gibbous","Full Moon","Waning Gibbous","Last Quarter","Waning Crescent"];const glyphs=["üåë","üåí","üåì","üåî","üåï","üåñ","üåó","üåò"];return {name:names[idx],emoji:glyphs[idx]}}
function illuminaStamp(now){const diff=Math.floor((now.getTime()-START_DATE)/86400000);const day=diff+1,week=Math.max(1,Math.floor(diff/7)+1),wday=((diff%7)+1);const p=phaseInfo(now);return {label:"Illumina Day "+day+" (Week "+week+", Day "+wday+")",phase:p.emoji+" "+p.name}}
function pulse(){overlay.style.opacity=1;setTimeout(()=>overlay.style.opacity=0,2800)}
function renderArchive(){const facets=jget(LS_FACETS,"[]");if(facets.length)archive.innerText="Facets: "+facets.join(" ‚Ä¢ ")}
function logMoon(kind,msg){const now=new Date(),stamp=illuminaStamp(now);const entry={ts:now.getTime(),phase:stamp.phase,illumina:stamp.label,kind:kind,msg:msg||""};const log=jget(LS_LOG,"[]");log.push(entry);jset(LS_LOG,log)}
function renderMoon(){const rows=jget(LS_LOG,"[]").slice().reverse();listMoon.innerHTML="";if(!rows.length){listMoon.innerHTML='<div class="row"><div class="dim">No entries yet.</div></div>';return}rows.forEach(function(r){const row=document.createElement("div");row.className="row";const left=document.createElement("div");const a=document.createElement("div");a.textContent=r.phase+" ¬∑ "+r.illumina;const b=document.createElement("div");b.className="dim";b.textContent=new Date(r.ts).toLocaleString();const c=document.createElement("div");c.className="dim";c.textContent=r.msg||"";left.appendChild(a);left.appendChild(b);left.appendChild(c);const actions=document.createElement("div");const copy=document.createElement("button");copy.className="btn";copy.textContent="copy";copy.onclick=function(){const text=r.phase+" | "+r.illumina+" | "+new Date(r.ts).toISOString()+(r.msg?(" | "+r.msg):"");navigator.clipboard.writeText(text)};actions.appendChild(copy);row.appendChild(left);row.appendChild(actions);listMoon.appendChild(row)})}
function unlockUI(){locked.style.display="none";app.classList.remove("hidden");app.setAttribute("aria-hidden","false");gateStatus.textContent="unlocked";transfer.classList.remove("hidden")}
function checkUnlock(){const ok=jget(LS_UNLOCK,"false");if(ok){unlockUI();var src=jget("mh.src","\"garlic.watch\"");logMoon("gate","auto-unlocked ¬∑ "+src)}}
function doUnlock(val){const expect=jget(LS_KEY,"");if(expect&&val===expect){jset(LS_UNLOCK,true);unlockUI();var src=jget("mh.src","\"manual\"");logMoon("gate","unlocked ¬∑ "+src);return true}return false}
function genCode(){return Math.random().toString(36).slice(2,6)+"-"+Math.random().toString(36).slice(2,6)+"-"+Math.random().toString(36).slice(2,6)}
function issueNext(who){const pack=jget(LS_NEXT,"{}");if(pack[who])return pack[who];const code=genCode();pack[who]=code;jset(LS_NEXT,pack);return code}
document.getElementById("tryKey").addEventListener("click",function(){const v=keyInput.value.trim();if(doUnlock(v)){keyInput.value=""}})
document.getElementById("keyBadge").addEventListener("click",function(){panelKey.style.display="flex"})
document.getElementById("closeKey").addEventListener("click",function(){panelKey.style.display="none"})
panelKey.addEventListener("click",function(e){if(e.target===panelKey)panelKey.style.display="none"})
badgeMoon.addEventListener("click",function(){panelMoon.style.display="flex";renderMoon()})
closeMoon.addEventListener("click",function(){panelMoon.style.display="none"})
panelMoon.addEventListener("click",function(e){if(e.target===panelMoon)panelMoon.style.display="none"})
truth.addEventListener("change",function(){const val=truth.value.trim();if(!val)return;pulse();const old=jget(LS_FACETS,"[]");old.push(val);jset(LS_FACETS,old);renderArchive();logMoon("facet",val)})
document.getElementById("transfer").addEventListener("click",function(e){const t=e.target;if(t.tagName!=="BUTTON"||!t.dataset.who)return;const code=issueNext(t.dataset.who);navigator.clipboard.writeText(code);copyStatus.textContent=t.dataset.who+" key copied"})
window.addEventListener("load",function(){renderArchive();checkUnlock()})
</script>
</body>
</html>
